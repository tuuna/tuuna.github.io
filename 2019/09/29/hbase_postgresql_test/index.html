<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Hbase + PostgreSQL测试 | 洛文小站</title><meta name=keywords content="Hbase,PostgreSQL,YCSB"><meta name=description content="文章目录  Hbase + PostgreSQL测试  基本信息 测试方法  HBASE PG   测试图例    基本信息 Hbase与PG测试使用YCSB压力测试工具
采用21w行数据+21w操作数来最大化模拟20G数据场景
测试方法 HBASE   首先下载YCSB，解压
  接下来创建测试数据库
hbase shell命令打开shell命令行
hbase(main):001:0> n_splits = 20 # HBase recommends (10 * number of regionservers) hbase(main):002:0> create 'usertable', 'cf', {SPLITS => (1..n_splits).map {|i| &#34;user#{1000+i*(9999-1000)/n_splits}&#34;}}   把hbase的conf目录下的|$HBASE_HOME/conf/hbase-site.xml(比如我本机是/usr/local/hbase/conf/hbase-site.xml)复制到我们下载的YCSB中的hbase14下的conf文件夹中
  接下来装载数据
$ ./bin/ycsb load hbase14 -P workloads/workloada -p table=usertable -p columnfamily=cf -p recordcount=210000 -p operationcount=210000 -p measurementtype=hdrhistogram -p hdrhistogram."><meta name=author content="赖杰"><link rel=canonical href=http://tuuna.top/2019/09/29/hbase_postgresql_test/><link href=http://tuuna.top/assets/css/stylesheet.min.46b233709fd2c907e04a2d946c05f4e1d6edaf81b562cbfdaf6f11aeaa32248c.css integrity="sha256-RrIzcJ/SyQfgSi2UbAX04dbtr4G1Ysv9r28RrqoyJIw=" rel="preload stylesheet" as=style><link rel=icon href=http://tuuna.top/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://tuuna.top/favicon16x16.png><link rel=icon type=image/png sizes=32x32 href=http://tuuna.top/favicon32x32.png><link rel=apple-touch-icon href=http://tuuna.top/apple-touch-icon.png><link rel=mask-icon href=http://tuuna.top/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.78.2"><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-123-45','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><meta property="og:title" content="Hbase + PostgreSQL测试"><meta property="og:description" content="文章目录  Hbase + PostgreSQL测试  基本信息 测试方法  HBASE PG   测试图例    基本信息 Hbase与PG测试使用YCSB压力测试工具
采用21w行数据+21w操作数来最大化模拟20G数据场景
测试方法 HBASE   首先下载YCSB，解压
  接下来创建测试数据库
hbase shell命令打开shell命令行
hbase(main):001:0> n_splits = 20 # HBase recommends (10 * number of regionservers) hbase(main):002:0> create 'usertable', 'cf', {SPLITS => (1..n_splits).map {|i| &#34;user#{1000+i*(9999-1000)/n_splits}&#34;}}   把hbase的conf目录下的|$HBASE_HOME/conf/hbase-site.xml(比如我本机是/usr/local/hbase/conf/hbase-site.xml)复制到我们下载的YCSB中的hbase14下的conf文件夹中
  接下来装载数据
$ ./bin/ycsb load hbase14 -P workloads/workloada -p table=usertable -p columnfamily=cf -p recordcount=210000 -p operationcount=210000 -p measurementtype=hdrhistogram -p hdrhistogram."><meta property="og:type" content="article"><meta property="og:url" content="http://tuuna.top/2019/09/29/hbase_postgresql_test/"><meta property="article:published_time" content="2019-09-29T11:10:32+00:00"><meta property="article:modified_time" content="2019-09-29T11:10:32+00:00"><meta property="og:site_name" content="洛文小站"><meta name=twitter:card content="summary"><meta name=twitter:title content="Hbase + PostgreSQL测试"><meta name=twitter:description content="文章目录  Hbase + PostgreSQL测试  基本信息 测试方法  HBASE PG   测试图例    基本信息 Hbase与PG测试使用YCSB压力测试工具
采用21w行数据+21w操作数来最大化模拟20G数据场景
测试方法 HBASE   首先下载YCSB，解压
  接下来创建测试数据库
hbase shell命令打开shell命令行
hbase(main):001:0> n_splits = 20 # HBase recommends (10 * number of regionservers) hbase(main):002:0> create 'usertable', 'cf', {SPLITS => (1..n_splits).map {|i| &#34;user#{1000+i*(9999-1000)/n_splits}&#34;}}   把hbase的conf目录下的|$HBASE_HOME/conf/hbase-site.xml(比如我本机是/usr/local/hbase/conf/hbase-site.xml)复制到我们下载的YCSB中的hbase14下的conf文件夹中
  接下来装载数据
$ ./bin/ycsb load hbase14 -P workloads/workloada -p table=usertable -p columnfamily=cf -p recordcount=210000 -p operationcount=210000 -p measurementtype=hdrhistogram -p hdrhistogram."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hbase + PostgreSQL测试","name":"Hbase \u002b PostgreSQL测试","description":"文章目录  Hbase + PostgreSQL测试  基本信息 测试方法  HBASE PG   测试图例    基本信息 Hbase与PG测试使用YCSB压力测试工具\n采用21w行数据+21w操作数来最大化模拟20G数据场景\n测试方法 HBASE   首先下载YCSB，解压\n  接下来创建测试数据库\nhbase shell命令打开shell …","keywords":["Hbase","PostgreSQL","YCSB"],"articleBody":"文章目录  Hbase + PostgreSQL测试  基本信息 测试方法  HBASE PG   测试图例    基本信息 Hbase与PG测试使用YCSB压力测试工具\n采用21w行数据+21w操作数来最大化模拟20G数据场景\n测试方法 HBASE   首先下载YCSB，解压\n  接下来创建测试数据库\nhbase shell命令打开shell命令行\nhbase(main):001:0 n_splits = 20 # HBase recommends (10 * number of regionservers) hbase(main):002:0 create 'usertable', 'cf', {SPLITS = (1..n_splits).map {|i| \"user#{1000+i*(9999-1000)/n_splits}\"}}   把hbase的conf目录下的|$HBASE_HOME/conf/hbase-site.xml(比如我本机是/usr/local/hbase/conf/hbase-site.xml)复制到我们下载的YCSB中的hbase14下的conf文件夹中\n  接下来装载数据\n$ ./bin/ycsb load hbase14 -P workloads/workloada -p table=usertable -p columnfamily=cf -p recordcount=210000 -p operationcount=210000 -p measurementtype=hdrhistogram -p hdrhistogram.fileoutput=true -p hdrhistogram.output.path=/Users/laijie/ -threads 50 -s # 注意这里面的path更换为本机可以存放文件的目录，并且注意这个文件等会还会用   装载好之后开始跑测试\n$ ./bin/ycsb run hbase14 -P workloads/workloada -p table=usertable -p columnfamily=cf -p recordcount=210000 -p operationcount=210000 -p measurementtype=hdrhistogram -p hdrhistogram.fileoutput=true -p hdrhistogram.output.path=/Users/laijie/ -threads 50 -s # 注意这里面的path更换为本机可以存放文件的目录，并且注意这个文件等会还会用    这里面使用的是workloada，想要测试其他情况更换参数即可\n Workload A：  重更新，50% 读 50% 写，例如 session sotre   Workload B：  读多写少，95% 读 5% 写，例如 photo tagging   Workload C：  只读：100% 读，例如 user profile cache   Workload D：  读最近更新：这个 workload 会插入新纪录，越新的纪录读取概率越大，例如：user status updates   Workload E：  小范围查询：这个 workload 会查询小范围的纪录，而不是单个纪录，例如：threaded conversations   Workload F：  读取-修改-写入：这个 workload 会读取一个纪录，然后修改这个纪录，最后写回，例如：user database     跑完之后测试结果如下\n2019-08-22 10:56:17:879 10 sec: 137084 operations; 13705.66 current ops/sec; est completion in 6 second READ: Count=68504, Max=178687, Min=813, Avg=3263.97, 90=4379, 99=9751, 99.9=23583, 99.99=144511 2019-08-22 10:56:21:776 13 sec: 210000 operations; 18710.8 current ops/sec; READ: Count=36475, Max=29167, Min=286, Avg=2597.52, 90=3033, 99=6147, 99.9=14079, 99.99=20399 UPDATE: Count=36086, Max=26079, Min=265, Avg=2701.23, 90=3137, 99=6315, 99.9=15215, 99.99=20463, RunTime(ms), 13898 [OVERALL], Throughput(ops/sec), 15110.087782414736 [TOTAL_GCS_PS_Scavenge], Count, 23 [TOTAL_GC_TIME_PS_Scavenge], Time(ms), 111 [TOTAL_GC_TIME%PS_Scavenge], Time(%), 0.7986760684990647 [TOTAL_GCS_PS_MarkSweep], Count, 1 [TOTAL_GC_TIME_PS_MarkSweep], Time(ms), 32 [TOTAL_GC_TIME%PS_MarkSweep], Time(%), 0.23024895668441503 [TOTAL_GCs], Count, 24 [TOTAL_GC_TIME], Time(ms), 143 [TOTAL_GC_TIME_%], Time(%), 1.0289250251834796 [READ], Operations, 104979 [READ], AverageLatency(us), 3032.414387639433 [READ], MinLatency(us), 286 [READ], MaxLatency(us), 178687 [READ], 95thPercentileLatency(us), 5127 [READ], 99thPercentileLatency(us), 9151 [READ], Return=OK, 104979 [CLEANUP], Operations, 100 [CLEANUP], AverageLatency(us), 191.15 [CLEANUP], MinLatency(us), 1 [CLEANUP], MaxLatency(us), 17615 [CLEANUP], 95thPercentileLatency(us), 20 [CLEANUP], 99thPercentileLatency(us), 1020 [UPDATE], Operations, 105021 [UPDATE], AverageLatency(us), 3187.596452138144 [UPDATE], MinLatency(us), 265 [UPDATE], MaxLatency(us), 260863 [UPDATE], 95thPercentileLatency(us), 5315 [UPDATE], 99thPercentileLatency(us), 9439 [UPDATE], Return=OK, 105021 然后我们会在设定的目录下面得到几个hdr文件，包括INSERT.hdr、READ.hdr、UPDATE.hdr等，我们要用histogram自带工作来进行图例的生成\n 首先我们解压必需软件文件夹中的HdrHistogram然后导入到IntelliJ Idea中，通过mvn工具，先build，然后package生成histogram.jar文件   接下来我们在目录根使用已经写好的脚本进行格式转换  $ ./HistogramLogProcessor -i INSERT.hdr -o insert -outputValueUnitRatio 1000 $ ./HistogramLogProcessor -i UPDATE.hdr -o update -outputValueUnitRatio 1000 $ ./HistogramLogProcessor -i READ.hdr -o read -outputValueUnitRatio 1000  格式转换后我们可以得到hgrm文件 最后在转换网址中即可得到图例  PG pg的基本步骤差不多,下面是一些\n 从Postgresql官网下载JDBC，放到 ycsb-0.15.0/jdbc-binding/lib 文件夹下，下载的是postgresql-42.2.6.jar 修改ycsb-0.15.0/jdbc-binding/conf/db.properties配置文件  db.driver=org.postgresql.Driver db.url=jdbc:postgresql://localhost/foo // foo替换为postgresql里面的一个数据库 db.user=lemon // postgresql的用户名 ddb.passwd=lemon // postgresql的密码   在ycsb-0.15.0文件夹下面执行下面命令，创建usertable表\n$ java -cp jdbc-binding/lib/jdbc-binding-0.15.0.jar:jdbc-binding/lib/postgresql-42.2.6.jar com.yahoo.ycsb.db.JdbcDBCreateTable -P jdbc-binding/conf/db.properties -n usertable   执行load程序，加载数据\n$ ./bin/ycsb load jdbc -s -P workloads/workloada -P jdbc-binding/conf/db.properties -cp jdbc-binding/lib/postgresql-42.2.6.jar -p measurementtype=hdrhistogram -p hdrhistogram.fileoutput=true -p hdrhistogram.output.path=../ -p recordcount=210000 -p operationcount=210000 -threads 50 -s # 仍然是要注意替换路径   执行run程序\n$ ./bin/ycsb run jdbc -s -P workloads/myworkload -P jdbc-binding/conf/db.properties -cp jdbc-binding/lib/postgresql-42.2.6.jar -p measurementtype=hdrhistogram -p hdrhistogram.fileoutput=true -p hdrhistogram.output.path=../ -threads 50 -s   [OVERALL], RunTime(ms), 424850 [OVERALL], Throughput(ops/sec), 494.29210309521005 [TOTAL_GCS_PS_Scavenge], Count, 35 [TOTAL_GC_TIME_PS_Scavenge], Time(ms), 134 [TOTAL_GC_TIME_%_PS_Scavenge], Time(%), 0.03154054372131341 [TOTAL_GCS_PS_MarkSweep], Count, 0 [TOTAL_GC_TIME_PS_MarkSweep], Time(ms), 0 [TOTAL_GC_TIME_%_PS_MarkSweep], Time(%), 0.0 [TOTAL_GCs], Count, 35 [TOTAL_GC_TIME], Time(ms), 134 [TOTAL_GC_TIME_%], Time(%), 0.03154054372131341 [READ], Operations, 104951 [READ], AverageLatency(us), 599.9616297129137 [READ], MinLatency(us), 61 [READ], MaxLatency(us), 61535 [READ], 95thPercentileLatency(us), 1230 [READ], 99thPercentileLatency(us), 2069 [READ], Return=OK, 104951 [CLEANUP], Operations, 50 [CLEANUP], AverageLatency(us), 999.9 [CLEANUP], MinLatency(us), 111 [CLEANUP], MaxLatency(us), 6411 [CLEANUP], 95thPercentileLatency(us), 3045 [CLEANUP], 99thPercentileLatency(us), 6411 [UPDATE], Operations, 105049 [UPDATE], AverageLatency(us), 189664.3654104275 [UPDATE], MinLatency(us), 6156 [UPDATE], MaxLatency(us), 20922367 [UPDATE], 95thPercentileLatency(us), 436223 [UPDATE], 99thPercentileLatency(us), 3047423 [UPDATE], Return=OK, 105049 转换为图的操作与Hbase一致\n测试图例 HBASE插入延迟图例\nHBASE更新读取延迟图例\nPG插入延迟图例\nPG更新读取延迟图例\n","wordCount":"481","inLanguage":"en","datePublished":"2019-09-29T11:10:32Z","dateModified":"2019-09-29T11:10:32Z","author":{"@type":"Person","name":"赖杰"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://tuuna.top/2019/09/29/hbase_postgresql_test/"},"publisher":{"@type":"Organization","name":"洛文小站","logo":{"@type":"ImageObject","url":"http://tuuna.top/favicon.ico"}}}</script></head><body class=single id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><noscript><style type=text/css>.theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=http://tuuna.top accesskey=h><img src=/cloud.png alt=logo aria-label=logo height=35>Home</a>
<span class=logo-switches><span class=theme-toggle><a id=theme-toggle accesskey=t><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></span><span class=lang-switch><span>|</span><ul><li><a href=http://tuuna.top/about/ title=About aria-label=About>About</a></li></ul></span></span></div><ul class=menu id=menu onscroll=menu_on_scroll()><li><a href=http://tuuna.top/archives/><span>Archive</span></a></li><li><a href=http://tuuna.top/tags/><span>Tag</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Hbase + PostgreSQL测试</h1><div class=post-meta>September 29, 2019&nbsp;·&nbsp;3 min&nbsp;·&nbsp;赖杰</div></header><div class=post-content><h1 id=文章目录>文章目录<a hidden class=anchor aria-hidden=true href=#文章目录>#</a></h1><ul><li>Hbase + PostgreSQL测试<ul><li><a href=https://mp.csdn.net/mdeditor/101709901#_3>基本信息</a></li><li>测试方法<ul><li><a href=https://mp.csdn.net/mdeditor/101709901#HBASE_11>HBASE</a></li><li><a href=https://mp.csdn.net/mdeditor/101709901#PG_119>PG</a></li></ul></li><li><a href=https://mp.csdn.net/mdeditor/101709901#_194>测试图例</a></li></ul></li></ul><h2 id=基本信息>基本信息<a hidden class=anchor aria-hidden=true href=#基本信息>#</a></h2><p>Hbase与PG测试使用<code>YCSB</code>压力测试工具</p><p>采用21w行数据+21w操作数来最大化模拟20G数据场景</p><h2 id=测试方法>测试方法<a hidden class=anchor aria-hidden=true href=#测试方法>#</a></h2><h3 id=hbase>HBASE<a hidden class=anchor aria-hidden=true href=#hbase>#</a></h3><ul><li><p>首先下载<code>YCSB</code>，解压</p></li><li><p>接下来创建测试数据库</p><p><code>hbase shell</code>命令打开shell命令行</p><pre><code class=language-hbase data-lang=hbase>hbase(main):001:0&gt; n_splits = 20 # HBase recommends (10 * number of regionservers)
hbase(main):002:0&gt; create 'usertable', 'cf', {SPLITS =&gt; (1..n_splits).map {|i| &quot;user#{1000+i*(9999-1000)/n_splits}&quot;}}
</code></pre></li><li><p>把hbase的conf目录下的|$HBASE_HOME/conf/hbase-site.xml(比如我本机是/usr/local/hbase/conf/hbase-site.xml)复制到我们下载的YCSB中的hbase14下的conf文件夹中</p></li><li><p>接下来装载数据</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ ./bin/ycsb load hbase14 -P workloads/workloada -p table<span style=color:#f92672>=</span>usertable -p columnfamily<span style=color:#f92672>=</span>cf -p recordcount<span style=color:#f92672>=</span><span style=color:#ae81ff>210000</span> -p operationcount<span style=color:#f92672>=</span><span style=color:#ae81ff>210000</span> -p measurementtype<span style=color:#f92672>=</span>hdrhistogram -p hdrhistogram.fileoutput<span style=color:#f92672>=</span>true -p hdrhistogram.output.path<span style=color:#f92672>=</span>/Users/laijie/ -threads <span style=color:#ae81ff>50</span> -s
<span style=color:#75715e># 注意这里面的path更换为本机可以存放文件的目录，并且注意这个文件等会还会用</span>
</code></pre></div></li><li><p>装载好之后开始跑测试</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ ./bin/ycsb run hbase14 -P workloads/workloada -p table<span style=color:#f92672>=</span>usertable -p columnfamily<span style=color:#f92672>=</span>cf -p recordcount<span style=color:#f92672>=</span><span style=color:#ae81ff>210000</span> -p operationcount<span style=color:#f92672>=</span><span style=color:#ae81ff>210000</span> -p measurementtype<span style=color:#f92672>=</span>hdrhistogram -p hdrhistogram.fileoutput<span style=color:#f92672>=</span>true -p hdrhistogram.output.path<span style=color:#f92672>=</span>/Users/laijie/ -threads <span style=color:#ae81ff>50</span> -s
<span style=color:#75715e># 注意这里面的path更换为本机可以存放文件的目录，并且注意这个文件等会还会用</span>
</code></pre></div></li></ul><blockquote><p>这里面使用的是workloada，想要测试其他情况更换参数即可</p><ul><li>Workload A：<ul><li>重更新，50% 读 50% 写，例如 session sotre</li></ul></li><li>Workload B：<ul><li>读多写少，95% 读 5% 写，例如 photo tagging</li></ul></li><li>Workload C：<ul><li>只读：100% 读，例如 user profile cache</li></ul></li><li>Workload D：<ul><li>读最近更新：这个 workload 会插入新纪录，越新的纪录读取概率越大，例如：user status updates</li></ul></li><li>Workload E：<ul><li>小范围查询：这个 workload 会查询小范围的纪录，而不是单个纪录，例如：threaded conversations</li></ul></li><li>Workload F：<ul><li>读取-修改-写入：这个 workload 会读取一个纪录，然后修改这个纪录，最后写回，例如：user database</li></ul></li></ul></blockquote><p>跑完之后测试结果如下</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>2019-08-22 10:56:17:879 <span style=color:#ae81ff>10</span> sec: <span style=color:#ae81ff>137084</span> operations; 13705.66 current ops/sec; est completion in <span style=color:#ae81ff>6</span> second READ: Count<span style=color:#f92672>=</span>68504, Max<span style=color:#f92672>=</span>178687, Min<span style=color:#f92672>=</span>813, Avg<span style=color:#f92672>=</span>3263.97, 90<span style=color:#f92672>=</span>4379, 99<span style=color:#f92672>=</span>9751, 99.9<span style=color:#f92672>=</span>23583, 99.99<span style=color:#f92672>=</span><span style=color:#ae81ff>144511</span>
2019-08-22 10:56:21:776 <span style=color:#ae81ff>13</span> sec: <span style=color:#ae81ff>210000</span> operations; 18710.8 current ops/sec; READ: Count<span style=color:#f92672>=</span>36475, Max<span style=color:#f92672>=</span>29167, Min<span style=color:#f92672>=</span>286, Avg<span style=color:#f92672>=</span>2597.52, 90<span style=color:#f92672>=</span>3033, 99<span style=color:#f92672>=</span>6147, 99.9<span style=color:#f92672>=</span>14079, 99.99<span style=color:#f92672>=</span><span style=color:#ae81ff>20399</span> UPDATE: Count<span style=color:#f92672>=</span>36086, Max<span style=color:#f92672>=</span>26079, Min<span style=color:#f92672>=</span>265, Avg<span style=color:#f92672>=</span>2701.23, 90<span style=color:#f92672>=</span>3137, 99<span style=color:#f92672>=</span>6315, 99.9<span style=color:#f92672>=</span>15215, 99.99<span style=color:#f92672>=</span>20463, RunTime<span style=color:#f92672>(</span>ms<span style=color:#f92672>)</span>, <span style=color:#ae81ff>13898</span>
<span style=color:#f92672>[</span>OVERALL<span style=color:#f92672>]</span>, Throughput<span style=color:#f92672>(</span>ops/sec<span style=color:#f92672>)</span>, 15110.087782414736
<span style=color:#f92672>[</span>TOTAL_GCS_PS_Scavenge<span style=color:#f92672>]</span>, Count, <span style=color:#ae81ff>23</span>
<span style=color:#f92672>[</span>TOTAL_GC_TIME_PS_Scavenge<span style=color:#f92672>]</span>, Time<span style=color:#f92672>(</span>ms<span style=color:#f92672>)</span>, <span style=color:#ae81ff>111</span>
<span style=color:#f92672>[</span>TOTAL_GC_TIME%PS_Scavenge<span style=color:#f92672>]</span>, Time<span style=color:#f92672>(</span>%<span style=color:#f92672>)</span>, 0.7986760684990647
<span style=color:#f92672>[</span>TOTAL_GCS_PS_MarkSweep<span style=color:#f92672>]</span>, Count, <span style=color:#ae81ff>1</span>
<span style=color:#f92672>[</span>TOTAL_GC_TIME_PS_MarkSweep<span style=color:#f92672>]</span>, Time<span style=color:#f92672>(</span>ms<span style=color:#f92672>)</span>, <span style=color:#ae81ff>32</span>
<span style=color:#f92672>[</span>TOTAL_GC_TIME%PS_MarkSweep<span style=color:#f92672>]</span>, Time<span style=color:#f92672>(</span>%<span style=color:#f92672>)</span>, 0.23024895668441503
<span style=color:#f92672>[</span>TOTAL_GCs<span style=color:#f92672>]</span>, Count, <span style=color:#ae81ff>24</span>
<span style=color:#f92672>[</span>TOTAL_GC_TIME<span style=color:#f92672>]</span>, Time<span style=color:#f92672>(</span>ms<span style=color:#f92672>)</span>, <span style=color:#ae81ff>143</span>
<span style=color:#f92672>[</span>TOTAL_GC_TIME_%<span style=color:#f92672>]</span>, Time<span style=color:#f92672>(</span>%<span style=color:#f92672>)</span>, 1.0289250251834796
<span style=color:#f92672>[</span>READ<span style=color:#f92672>]</span>, Operations, <span style=color:#ae81ff>104979</span>
<span style=color:#f92672>[</span>READ<span style=color:#f92672>]</span>, AverageLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, 3032.414387639433
<span style=color:#f92672>[</span>READ<span style=color:#f92672>]</span>, MinLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, <span style=color:#ae81ff>286</span>
<span style=color:#f92672>[</span>READ<span style=color:#f92672>]</span>, MaxLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, <span style=color:#ae81ff>178687</span>
<span style=color:#f92672>[</span>READ<span style=color:#f92672>]</span>, 95thPercentileLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, <span style=color:#ae81ff>5127</span>
<span style=color:#f92672>[</span>READ<span style=color:#f92672>]</span>, 99thPercentileLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, <span style=color:#ae81ff>9151</span>
<span style=color:#f92672>[</span>READ<span style=color:#f92672>]</span>, Return<span style=color:#f92672>=</span>OK, <span style=color:#ae81ff>104979</span>
<span style=color:#f92672>[</span>CLEANUP<span style=color:#f92672>]</span>, Operations, <span style=color:#ae81ff>100</span>
<span style=color:#f92672>[</span>CLEANUP<span style=color:#f92672>]</span>, AverageLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, 191.15
<span style=color:#f92672>[</span>CLEANUP<span style=color:#f92672>]</span>, MinLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, <span style=color:#ae81ff>1</span>
<span style=color:#f92672>[</span>CLEANUP<span style=color:#f92672>]</span>, MaxLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, <span style=color:#ae81ff>17615</span>
<span style=color:#f92672>[</span>CLEANUP<span style=color:#f92672>]</span>, 95thPercentileLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, <span style=color:#ae81ff>20</span>
<span style=color:#f92672>[</span>CLEANUP<span style=color:#f92672>]</span>, 99thPercentileLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, <span style=color:#ae81ff>1020</span>
<span style=color:#f92672>[</span>UPDATE<span style=color:#f92672>]</span>, Operations, <span style=color:#ae81ff>105021</span>
<span style=color:#f92672>[</span>UPDATE<span style=color:#f92672>]</span>, AverageLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, 3187.596452138144
<span style=color:#f92672>[</span>UPDATE<span style=color:#f92672>]</span>, MinLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, <span style=color:#ae81ff>265</span>
<span style=color:#f92672>[</span>UPDATE<span style=color:#f92672>]</span>, MaxLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, <span style=color:#ae81ff>260863</span>
<span style=color:#f92672>[</span>UPDATE<span style=color:#f92672>]</span>, 95thPercentileLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, <span style=color:#ae81ff>5315</span>
<span style=color:#f92672>[</span>UPDATE<span style=color:#f92672>]</span>, 99thPercentileLatency<span style=color:#f92672>(</span>us<span style=color:#f92672>)</span>, <span style=color:#ae81ff>9439</span>
<span style=color:#f92672>[</span>UPDATE<span style=color:#f92672>]</span>, Return<span style=color:#f92672>=</span>OK, <span style=color:#ae81ff>105021</span>
</code></pre></div><p>然后我们会在设定的目录下面得到几个hdr文件，包括INSERT.hdr、READ.hdr、UPDATE.hdr等，我们要用histogram自带工作来进行图例的生成</p><ul><li>首先我们解压必需软件文件夹中的HdrHistogram然后导入到IntelliJ Idea中，通过mvn工具，先build，然后package生成histogram.jar文件</li></ul><p><img src="https://img-blog.csdnimg.cn/20190929190526468.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xqXzU1MDU2NjE4MQ==,size_16,color_FFFFFF,t_70" alt=在这里插入图片描述></p><ul><li>接下来我们在目录根使用已经写好的脚本进行格式转换</li></ul><p><img src=https://img-blog.csdnimg.cn/20190929190537557.png alt=在这里插入图片描述></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ ./HistogramLogProcessor -i INSERT.hdr -o insert -outputValueUnitRatio <span style=color:#ae81ff>1000</span>

$ ./HistogramLogProcessor -i UPDATE.hdr -o update -outputValueUnitRatio <span style=color:#ae81ff>1000</span>
$ ./HistogramLogProcessor -i READ.hdr -o read -outputValueUnitRatio <span style=color:#ae81ff>1000</span>
</code></pre></div><ul><li>格式转换后我们可以得到hgrm文件</li><li>最后在<a href=http://hdrhistogram.github.io/HdrHistogram/plotFiles.html>转换网址</a>中即可得到图例</li></ul><h3 id=pg>PG<a hidden class=anchor aria-hidden=true href=#pg>#</a></h3><p>pg的基本步骤差不多,下面是一些</p><ul><li>从Postgresql官网下载JDBC，放到 ycsb-0.15.0/jdbc-binding/lib 文件夹下，下载的是postgresql-42.2.6.jar</li><li>修改ycsb-0.15.0/jdbc-binding/conf/db.properties配置文件</li></ul><pre><code>db.driver=org.postgresql.Driver

db.url=jdbc:postgresql://localhost/foo  // foo替换为postgresql里面的一个数据库
db.user=lemon                            // postgresql的用户名
ddb.passwd=lemon                        // postgresql的密码
</code></pre><ul><li><p>在ycsb-0.15.0文件夹下面执行下面命令，创建usertable表</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ java -cp jdbc-binding/lib/jdbc-binding-0.15.0.jar:jdbc-binding/lib/postgresql-42.2.6.jar com.yahoo.ycsb.db.JdbcDBCreateTable -P jdbc-binding/conf/db.properties -n usertable
</code></pre></div></li><li><p>执行load程序，加载数据</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ ./bin/ycsb load jdbc -s -P workloads/workloada -P jdbc-binding/conf/db.properties -cp jdbc-binding/lib/postgresql-42.2.6.jar -p measurementtype<span style=color:#f92672>=</span>hdrhistogram -p hdrhistogram.fileoutput<span style=color:#f92672>=</span>true -p hdrhistogram.output.path<span style=color:#f92672>=</span>../ -p recordcount<span style=color:#f92672>=</span><span style=color:#ae81ff>210000</span> -p operationcount<span style=color:#f92672>=</span><span style=color:#ae81ff>210000</span> -threads <span style=color:#ae81ff>50</span> -s <span style=color:#75715e># 仍然是要注意替换路径</span>
</code></pre></div></li><li><p>执行run程序</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ ./bin/ycsb run jdbc -s -P workloads/myworkload -P jdbc-binding/conf/db.properties -cp jdbc-binding/lib/postgresql-42.2.6.jar -p measurementtype<span style=color:#f92672>=</span>hdrhistogram -p hdrhistogram.fileoutput<span style=color:#f92672>=</span>true -p hdrhistogram.output.path<span style=color:#f92672>=</span>../ -threads <span style=color:#ae81ff>50</span> -s
</code></pre></div></li></ul><p><img src="https://img-blog.csdnimg.cn/20190929190612733.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xqXzU1MDU2NjE4MQ==,size_16,color_FFFFFF,t_70" alt=在这里插入图片描述></p><pre><code>[OVERALL], RunTime(ms), 424850
[OVERALL], Throughput(ops/sec), 494.29210309521005
[TOTAL_GCS_PS_Scavenge], Count, 35
[TOTAL_GC_TIME_PS_Scavenge], Time(ms), 134
[TOTAL_GC_TIME_%_PS_Scavenge], Time(%), 0.03154054372131341
[TOTAL_GCS_PS_MarkSweep], Count, 0
[TOTAL_GC_TIME_PS_MarkSweep], Time(ms), 0
[TOTAL_GC_TIME_%_PS_MarkSweep], Time(%), 0.0
[TOTAL_GCs], Count, 35
[TOTAL_GC_TIME], Time(ms), 134
[TOTAL_GC_TIME_%], Time(%), 0.03154054372131341
[READ], Operations, 104951
[READ], AverageLatency(us), 599.9616297129137
[READ], MinLatency(us), 61
[READ], MaxLatency(us), 61535
[READ], 95thPercentileLatency(us), 1230
[READ], 99thPercentileLatency(us), 2069
[READ], Return=OK, 104951
[CLEANUP], Operations, 50
[CLEANUP], AverageLatency(us), 999.9
[CLEANUP], MinLatency(us), 111
[CLEANUP], MaxLatency(us), 6411
[CLEANUP], 95thPercentileLatency(us), 3045
[CLEANUP], 99thPercentileLatency(us), 6411
[UPDATE], Operations, 105049
[UPDATE], AverageLatency(us), 189664.3654104275
[UPDATE], MinLatency(us), 6156
[UPDATE], MaxLatency(us), 20922367
[UPDATE], 95thPercentileLatency(us), 436223
[UPDATE], 99thPercentileLatency(us), 3047423
[UPDATE], Return=OK, 105049
</code></pre><p>转换为图的操作与Hbase一致</p><h2 id=测试图例>测试图例<a hidden class=anchor aria-hidden=true href=#测试图例>#</a></h2><p><strong>HBASE插入延迟图例</strong></p><p><img src="https://img-blog.csdnimg.cn/20190929190628522.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xqXzU1MDU2NjE4MQ==,size_16,color_FFFFFF,t_70" alt=在这里插入图片描述></p><p><strong>HBASE更新读取延迟图例</strong></p><p><img src="https://img-blog.csdnimg.cn/20190929190640614.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xqXzU1MDU2NjE4MQ==,size_16,color_FFFFFF,t_70" alt=在这里插入图片描述></p><p><strong>PG插入延迟图例</strong></p><p><img src="https://img-blog.csdnimg.cn/20190929190658227.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xqXzU1MDU2NjE4MQ==,size_16,color_FFFFFF,t_70" alt=在这里插入图片描述></p><p><strong>PG更新读取延迟图例</strong></p><p><img src="https://img-blog.csdnimg.cn/20190929190709238.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xqXzU1MDU2NjE4MQ==,size_16,color_FFFFFF,t_70" alt=在这里插入图片描述></p></div><footer class=post-footer><div style="padding:10px 0;margin:20px auto;width:100%;font-size:16px;text-align:center"><button id=rewardButton disable=enable onclick="var qr=document.getElementById('QR');if(qr.style.display==='none'){qr.style.display='block';}else{qr.style.display='none'}">
<span>打赏</span></button><div id=QR style=display:none><div id=wechat style=display:inline-block><a class=fancybox rel=group><img id=wechat_qr src=/wechat.jpeg alt="WeChat Pay"></a><p>微信打赏</p></div><div id=alipay style=display:inline-block><a class=fancybox rel=group><img id=alipay_qr src=/alipay.jpeg alt=Alipay></a><p>支付宝打赏</p></div></div></div><ul class=post-tags><li><a href=http://tuuna.top/tags/hbase>Hbase</a></li><li><a href=http://tuuna.top/tags/postgresql>PostgreSQL</a></li><li><a href=http://tuuna.top/tags/ycsb>YCSB</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2020 <a href=http://tuuna.top>洛文小站</a></span>
<span>&#183;</span>
<span>备案号 <a href=http://www.beian.miit.gov.cn/ rel="noopener noreferrer">蜀ICP备15022210号-3</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top" accesskey=g><button class=top-link id=top-link type=button><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){if(localStorage.getItem("menu-scroll-position")){document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position");}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});});});var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft);}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script></body></html>